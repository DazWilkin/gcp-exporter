groups:
  - name: gcp_exporter
    rules:
      - alert: gcp_artifact_registry_repositories
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_artifact_registry_repositories{}[15m]) > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Artifact Registry repositories exist
      - alert: gcp_cloud_endpoints_services
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_cloud_endpoints_services{}[15m]) > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Cloud Endpoints services deployed
      - alert: gcp_cloud_functions_running
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_cloud_functions_functions{}[15m]) > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Cloud Functions running
      - alert: gcp_cloud_run_services_running
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_cloud_run_services{}[15m]) > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Cloud Run services running
      - alert: gcp_compute_engine_instances_running
        expr: gcp_compute_engine_instances{} > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Compute Engine Instances running
      - alert: gcp_forwarding_rules_running
        expr: gcp_compute_engine_forwardingrules{} > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Compute Engine ForwardingRules running
      - alert: gcp_kubernetes_clusters_running
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_kubernetes_engine_cluster_up{}[15m]) > 0
        for: 6h
        labels:
          severity: page
        annotations:
          summary: GCP Kubernetes Engine clusters running
      # - alert: gcp_storage_buckets
      #   expr: gcp_storage_buckets{} > 0
      #   for: 6h
      #   labels:
      #     severity: warning
      #   annotations:
      #     summary: GCP Storage buckets exist
  - name: gcp_status
    rules:
      - alert: gcp_status_services
        # `15m` matches the prometheus.yml scrape_interval
        expr: gcp_status_services{} != 41
        for: 15m
        labels:
          severity: page
        annotations:
          summary: GCP Status Services availability discrepancy
      - alert: gcp_status_up
        # `15m` matches the prometheus.yml scrape_interval
        expr: min_over_time(gcp_status_up{}[15m]) != 1.0
        for: 15m
        labels:
          severity: page
        annotations:
          summary: GCP Status Service {{ $labels.service }} down
